using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using Gmou.BusinessAccessLayer;
using Gmou.DomainModelEntities;
using Gmou.Web.Models;

namespace Gmou.Web.Controllers
{
    public class WayBillController : Controller
    {
        //
        // GET: /WayBill/

        public ActionResult Index()
        {
            //WayBillBAL.GetCashVivraiSerial()
            return PartialView(@"~/Views\WayBill\_wayBill.cshtml");
        }
        public ActionResult AddVivrani()
        {
            var user = ((UserValidation.CustomPrincipal)(HttpContext.Request.RequestContext.HttpContext.User)).User;
            Vivirani model = new Vivirani { UserID = user.LoginEmpID, DepartmentId = user.DepartmentID, IsSubmitted = false };
            var data = WayBillBAL.GetCashVivraiSerial(model);
            VivraniViewModel vivraniviewmodel = new VivraniViewModel
            {
            busowner  = new SelectList(data.BusOwner,"BusOwnerID","BusOwnerName"),
            bus = new SelectList(data.bus, "BusID", "BusNumber"),
             VivraniSerialNumber = data.VivraniSerialNumber
            };
            ViewBag.serialnumber = data.VivraniSerialNumber;
            return PartialView(@"~/Views\Admin\Partial\_vivraniEnrty.cshtml", vivraniviewmodel);

        }
        [HttpPost]
        public ActionResult AddVivraniDeatil(VivraniDetails model)
        {
           var data= BusinessAccessLayer.WayBillBAL.AddVivraniDetails(model);
           return Json(data, JsonRequestBehavior.AllowGet);
        }

    }
}
