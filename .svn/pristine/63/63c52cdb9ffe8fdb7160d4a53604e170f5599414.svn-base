using Gmou.DataRepository;
using Gmou.DomainModelEntities;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace Gmou.BusinessAccessLayer
{
    public class BALFuel
    {
       public static List<FuelTypeModel> BALGetAllFuel()
        {
          return  DataRepository.FuelRepository.GetAllFuelList().ToList();
        }
       public static List<BusList> BALGetBuses()
       {
           return DataRepository.FuelRepository.GetAllBusList().ToList();
       }
       public static List<FuelStationModel> BALGetAllStation()
       {
           return DataRepository.FuelRepository.GetAllFuelStations().ToList();
       }

        public static List<FuelCashMemoModel> BALSaveCashMemoDetails(FuelCashMemo model)
       {

           return DataRepository.FuelRepository.InsertCashMemo(model).ToList();
       }

        public static decimal BALGetFuelPrice(int pumpid, int fueltypeid)
        {

            return DataRepository.FuelRepository.GetFuelPrice(pumpid, fueltypeid);

        }

        public static List<FuelPriceListShowModel> BALGetAllFuelRate()
        {
               return DataRepository.FuelRepository.GetAllFuelRate().ToList();

        }

        public static bool BALSaveFuelDetails(FuelPriceListModel model)
        {

            return DataRepository.FuelRepository.SaveFuelDetails(model);
        }

        public static bool BALUpdatefuelDetail(UpdateFuelModel model)
        {
            return DataRepository.FuelRepository.UpdatefuelDetail(model);

        }
        public static bool BALInsertChit(ChitFuel model)
        {
            return DataRepository.FuelRepository.InsertChit(model);

        }
        public static List<ChitFuelModel> BALGetAllChitDetailsByUser(int userID)
        {
            return DataRepository.FuelRepository.GetAllChitDetailsByUser(userID).ToList();

        }
        public static bool BALInsertReceivingChit(FuelRecieve model)
        {
            return DataRepository.FuelRepository.InsertReceivingChit(model);

        }
        public static List<StockModel> BALGetStockData(int pumpid)
        {
            return DataRepository.FuelRepository.GetStockByPumpName(pumpid).ToList();

        }
        public static AllSalesModel BALGetChitFuelSalesDetails(int pumpid)
        {
            var data = FuelRepository.GetChitFuelSalesDetails(pumpid).ToList();
          List<ChitFuelSale> _temp = new List<ChitFuelSale>();
           
            var d = data.ToList();//.ToArray()
            
        
           var obj = new AllSalesModel();
            foreach( var item in d)
            {
                if(item.Fueltype==1)
                {
                    obj.PetrolQuantity = item.PetrolQuantity;
                    obj.PetrolAmount = item.PetrolAmount;
                    obj.DeiselQuantity = item.DeiselQuantity;
                    obj.DeiselAmount = item.DeiselAmount;
                    obj.LubricantQuantity = item.LubricantQuantity;
                    obj.LubricantAmount = item.LubricantAmount;
                }
                if (item.Fueltype == 2)
                {
                    obj.OPetrolQuantity = item.PetrolQuantity;
                    obj.OPetrolAmount = item.PetrolAmount;
                    obj.ODeiselQuantity = item.DeiselQuantity;
                    obj.ODeiselAmount = item.DeiselAmount;
                    obj.OLubricantQuantity = item.LubricantQuantity;
                    obj.OLubricantAmount = item.LubricantAmount;
                }

                if (item.Fueltype == 3)
                {
                    obj.SPetrolQuantity = item.PetrolQuantity;
                    obj.SPetrolAmount = item.PetrolAmount;
                    obj.SDeiselQuantity = item.DeiselQuantity;
                    obj.SDeiselAmount = item.DeiselAmount;
                    obj.SLubricantQuantity = item.LubricantQuantity;
                    obj.SLubricantAmount = item.LubricantAmount;
                }
               
                

            }
            return obj;

        }
        public static FuelChashModel BALGetCashFuelSalesDetails(CashFuleSale model)
        {
            return FuelRepository.GetCashFuelSalesDetails(model);
        }
        public static bool BALInsertStaffFule(staffFuel model)
        {
            return FuelRepository.InsertStaffFule(model);
            
        }
        public static bool BALInsertOtherFule(FuelOtherSale model)
        {
            return FuelRepository.InsertOtherFule(model);
        }
        public static List< RecieveFuleModel> BALGetRecievingFuelDetails(int pumpid)
        {
            return FuelRepository.GetRecievingFuelDetails(pumpid).ToList();
        }
        
    }
}
