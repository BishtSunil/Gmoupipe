@{
    ViewBag.Title = "BusInformation";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<script src="~/Scripts/Admin/validation.js"></script>
<script src="~/Scripts/LTE/ui/jquery-ui.js"></script>
<link href="~/Scripts/LTE/ui/jquery-ui.css" rel="stylesheet" />
<script src="~/Scripts/LTE/ui/date.format.js"></script>

<link href="~/Content/jquery.loader.css" rel="stylesheet" />
<script src="~/Scripts/GmouScripts/jquery.loader.js"></script>
<div id="busInformation">
    <div class="col-md-12 marT20">
        <div class="box box-success">
            <div class="boxHeading">
                <b>Bus Detail</b>
                <a href="" class="pull-right hide" id="ancAddNewStore" title="Add a Store"><i class="fa fa-plus"></i> Add Related Account</a>
            </div>
            <div class="box-body">
                <table id="tblAccount" style="width:100%" class="tbl20 alignROdd">
                    <tbody>
                        <tr>
                            <td>
                              bus number <req>*</req> 
                            </td>
                            <td>
                                <input type="text" id="txtBusNumber" accesskey="a" class="txt100PValidBreak">
                            </td>
                            <td class="alignR_PR5">
                                Permit Number <req>*</req> 
                            </td>
                            <td><input type="text" id="txtPermitNumber" accesskey="a" onchange="fillPermit()" class="txt100PValidBreak"></td>
                        </tr>
                        <tr>
                            <td>
                               Owner Name <req>*</req> 
                            </td>
                            <td>
                                <input type="text" id="txtOwnerName" accesskey="a" class="txt100PValidBreak">

                            </td>
                            <td class="alignR">
                                Father Name
                            </td>
                            <td>
                                <input type="text" id="txtFatherName" class="txt100P">
                            </td>
                        </tr>
                        <tr>
                            <td>
                                Address
                            </td>
                            <td>
                                <input name="txtAddress" type="text" id="txtAddress" tabindex="3" class="txt100P">
                            </td>
                            <td class="alignR">
                                 Member of Company From <req>*</req>
                            </td>
                            <td>
                                <input type="text" id="txtMember" accesskey="a" class="txt100 datepicker">
                                <img src="~/Images/calendar-icon-blue.png" style="margin-left: -4px;" />
                            </td>
                        </tr>
                        <tr>
                            <td class="alignR">
                                Set <req>*</req> 
                            </td>
                            <td>
                                <select id="txtSet" accesskey="a" onchange="selectDipoo()" style="padding: 4px 28px;">
                                    <option>Select Set</option>
                                    <option>1</option>
                                    <option>2</option>
                                    <option>3</option>
                                    <option>4</option>
                                    <option>5</option>
                                </select>

                            </td>
                            <td>
                                Dipoo <req>*</req> 
                            </td>
                            <td>
                                <select id="txtDipoo" accesskey="a" style="padding: 4px 19px;">
                                    <option>Select Dipoo</option>
                                    <option value="1">Pauri</option>
                                    <option value="2">Kotdwar</option>
                                    <option value="3">Rishikesh</option>
                                    <option value="4">Karanprayag</option>
                                    <option value="5">Srinagar</option>
                                </select>

                            </td>

                        </tr>
                        <tr>
                            <td class="alignR">
                              Entry Deposit <req>*</req> 
                            </td>
                            <td>
                                <input type="text" id="txtEntryDeposit" accesskey="a" class="txt100">
                            </td>
                            <td class="alignR">
                               Recipt Number <req>*</req> 
                            </td>
                            <td>
                                <input type="text" id="txtReciptNo" accesskey="a" class="txt100">
                            </td>
                        </tr>
                        <tr>
                            <td class="alignR">
                                Caution Money <req>*</req> 
                            </td>
                            <td>
                                <input type="text" id="txtCautionMoney" accesskey="a" class="txt100">
                            </td>
                            <td class="alignR">
                               Recipt Number <req>*</req> 
                            </td>
                            <td>
                                <input type="text" id="txtCautionMoneyReciptNo" accesskey="a" class="txt100">
                            </td>
                            <td class="alignR">
                                Caution Money Deposit Date <req>*</req> 
                            </td>
                            <td>
                                <input type="text" id="txtCautionMoneyDate" accesskey="a" class="txt100 datepicker">
                                <img src="~/Images/calendar-icon-blue.png" style="margin-left: -4px;" />
                            </td>

                        </tr>
                        <tr>
                            <td class="alignR">
                               Remaining Money <req>*</req> 
                            </td>
                            <td>
                                <input type="text" id="txtRemainingMoney" accesskey="a" class="txt100">
                            </td>
                            <td class="alignR">
                               EMI/Month <req>*</req> 
                            </td>
                            <td>
                                <input type="text" id="txtEmi" accesskey="a" class="txt100">
                            </td>
                        </tr>


                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="col-md-12 marT20">
        <div class="col-md-6 marT20">
            <div class="box box-success">
                <div class="boxHeading">
                    <b> Bus Detail</b>
                    <a href="" class="pull-right hide" id="ancAddNewStore" title="Add a Store"><i class="fa fa-plus"></i> Add Related Account</a>
                </div>
                <div class="box-body">
                    <table id="tblAccount" style="width:100%" class="tbl20 alignROdd">
                        <tbody>
                            <tr>
                                <td>
                                    Bus guarantor1 Name <req>*</req> 
                                </td>
                                <td>
                                    <input type="text" id="txtguarantor1Name" accesskey="a" class="txt100PValidBreak">
                                </td>
                               
                            </tr>
                            <tr>
                                <td class="alignR_PR5">
                                   guarantor1 Bus Number <req>*</req> 
                                </td>
                                <td><input type="text" id="txtguarantor1BusNumber" accesskey="a" class="txt100PValidBreak"></td>
                            </tr>
                            <tr>
                                <td>
                                   Bus guarantor2 Name <req>*</req> 
                                </td>
                                <td>
                                    <input type="text" id="txtguarantor2Name" accesskey="a" class="txt100PValidBreak">
                                </td>
                               
                            </tr>
                            <tr>
                                <td class="alignR_PR5">
                                    guarantor2 Bus Number <req>*</req> 
                                </td>
                                <td><input type="text" id="txtguarantor2BusNumber" accesskey="a" class="txt100PValidBreak"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="col-md-6 marT20">
            <div class="box box-success">
                <div class="boxHeading">
                    <b> Bus Detail</b>
                    <a href="" class="pull-right hide" id="ancAddNewStore" title="Add a Store"><i class="fa fa-plus"></i> Add Related Account</a>
                </div>
                <div class="box-body">
                    <table id="tblAccount" style="width:100%" class="tbl20 alignROdd">
                        <tbody>
                            <tr>
                                <td>
                                    Bus Dipoo
                                </td>
                                <td>
                                    <input type="text" id="txtBusDipoo" class="txt100PValidBreak">
                                </td>

                            </tr>
                            <tr>
                                <td>
                                   Registration Number <req>*</req> 
                                </td>
                                <td>
                                    <input type="text" id="txtRegistrationNo" accesskey="a" class="txt100PValidBreak">
                                </td>

                            </tr>
                            <tr>
                                <td>
                                    Permit Number
                                </td>
                                <td>
                                    <input type="text" id="txtPermitNo" class="txt100PValidBreak">
                                </td>

                            </tr>
                            <tr>
                                <td>
                                   Model <req>*</req> 
                                </td>
                                <td>
                                    <input type="text" id="txtModel" accesskey="a" class="txt100PValidBreak">
                                </td>

                            </tr>
                            <tr>
                                <td>
                                   No Of Seats <req>*</req> 
                                </td>
                                <td>
                                    <input type="text" id="txtNoOfSeats" accesskey="a" class="txt100PValidBreak">
                                </td>

                            </tr>
                            <tr>
                                <td>
                                   Chassis Number <req>*</req> 
                                </td>
                                <td>
                                    <input type="text" id="txtChassisNo" accesskey="a" class="txt100PValidBreak">
                                </td>

                            </tr>
                            <tr>
                                <td>
                                   Engine Number <req>*</req> 
                                </td>
                                <td>
                                    <input type="text" id="txtEngineNo" accesskey="a" class="txt100PValidBreak">
                                </td>

                            </tr>

                            <tr>
                                <td>
                                   Toll Tax <req>*</req> 
                                </td>
                                <td>
                                    <input type="text" id="txtTollTax" accesskey="a" class="txt100PValidBreak">
                                </td>

                            </tr>
                            <tr>
                                <td>
                                 Fitness <req>*</req> 
                                </td>
                                <td>
                                    <input type="text" id="txtFitness" accesskey="a" class="txt100PValidBreak">
                                </td>

                            </tr>
                            <tr>
                                <td>
                                    Insurance Company Name <req>*</req> 
                                </td>
                                <td>
                                    <input type="text" id="txtInsuranceName" accesskey="a" class="txt100PValidBreak">
                                </td>
                                      

                            </tr>
                            <tr>
                                <td>
                                     Insurance Company Address <req>*</req>
                                </td>
                                <td>
                                    <input type="text" id="txtInsuranceaddress" accesskey="a" class="txt100PValidBreak">
                                </td>           
                            </tr>
                            <tr>
                                <td>
                                   Valid <req>*</req>
                                </td>
                                <td>
                                    <input type="text" id="txtValid " accesskey="a" class="txt100PValidBreak datepicker">
                                    <img src="~/Images/calendar-icon-blue.png" style="margin-left: -4px;" />
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="box-footer clearfix" style="padding-right:30px">
        <input type="button" id="btnSaveBusInformation" value="Save" class="pull-left btn btn-primary" onclick="saveBusesDetail()" style="padding:4px 22px 6px 15px;margin-left: 40px;" />
    </div>
</div>
<script type="text/javascript">
    $(function () {
        $(".datepicker").datepicker();
    });
    function fillPermit() {
        setControlValue("txtPermitNo2", getControlValueN("txtPermitNumber"))
    }
    function selectDipoo() {
        setControlValue("txtDipoo", getControlValueN("txtSet"))
        setControlValue("txtBusDipoo", document.getElementById('txtDipoo').options[document.getElementById('txtDipoo').selectedIndex].text)
    }

    function saveBusesDetail()
    {
        var valid = validateTextBoxes('busInformation');
        if (valid == true)
        {
            var obj = new Object();
            obj.bus_number = getControlValueN("txtBusNumber");
            obj.permit_number = getControlValueN("txtPermitNumber");
            obj.bus_owner_name = getControlValueN("txtOwnerName");
            obj.owner_father_name = getControlValueN("txtFatherName");
            obj.owner_address = getControlValueN("txtAddress");
            obj.registration_date = getControlValueN("txtMember");

            obj.setid = getControlValueN("txtSet");
            obj.bus_operating_center = getControlValueN("txtDipoo");


            obj.entry_amount = getControlValueN("txtEntryDeposit");
            obj.entry_reciept_number = getControlValueN("txtReciptNo");
            obj.security_amount = getControlValueN("txtCautionMoney");
            obj.security_money_reciept = getControlValueN("txtCautionMoneyReciptNo");
            obj.payment_date = getControlValueN("txtCautionMoneyDate");
            obj.remaining_amount = getControlValueN("txtRemainingMoney");
            obj.road_tax = getControlValueN("txtTollTax");
            obj.gauranter1 = getControlValueN("txtguarantor1Name");
            obj.gauranter1_bus = getControlValueN("txtguarantor1BusNumber");
            obj.gauranter2 = getControlValueN("txtguarantor2Name");
            obj.gauranter2_bus = getControlValueN("txtguarantor2BusNumber");
            obj.registration_number = getControlValueN("txtRegistrationNo");
            obj.model = getControlValueN("txtModel");
            obj.seats = getControlValueN("txtNoOfSeats");
            obj.chesis_number = getControlValueN("txtChassisNo");
            obj.engine_number = getControlValueN("txtEngineNo");
            obj.fitness = getControlValueN("txtFitness");
            obj.company_name = getControlValueN("txtInsuranceName");
            obj.company_address = getControlValueN("txtInsuranceaddress");
            obj.validity = getControlValueN("txtValid");
            obj.emi = getControlValueN("txtEmi");
            obj.validity = getControlValueN("txtValid");

            //    callServiceMethod("{'or':" + JSON.stringify(obj) + "'}", "", "SaveEmpolyee", successMethodAfterInsertUpdate, "", "",
            //                                    false, "", true, saveEmployee_scs, "", "", "");
            //}

            //function saveEmployee_scs() {
            //    alert('success')
            //}
            $.ajax({
                type: "POST",
                url: '/Buses/SaveBusDetail',
                data: JSON.stringify(obj),

                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {

                    alert("Done");
                    $("#myModal").modal('show');
                    //if (successMethodToCall != "") {
                    //    successMethodToCall(data, rowIdToDelete, rowParentContainerId, shallLoadTemplete, templeteToLoad, shallCallOtherMethod, otherMethodToCall, parameter1InOtherMethod, parameter2InOtherMethod, parameter3InOtherMethod);
                    //}
                    //else if (shallCallOtherMethod) {
                    //    if (otherMethodToCall != "") {
                    //        otherMethodToCall(parameter1InOtherMethod, parameter2InOtherMethod, parameter3InOtherMethod, data);
                    //    }
                    //}
                },
                error: OnError
            });
        }
    }


    $(document).ready(function () {


        var id = '@ViewBag.empId'
        if (id != "") {


            $.ajax({
                type: 'GET',
                data: { 'busID': 1 },
                url: "/Admin/EditBusDetailDetail",
                success: function (data) {
                    $('body').loader('show');

                    // alert(data[0].WorkingDepartment)

                    $('#IDhidden').val(data[0].EmployeeID);
                    var paymentDate = new Date(parseInt(data[0].payment_date.substr(6))).format("dd/mm/yyyy")
                    var member = new Date(parseInt(data[0].registration_date.substr(6))).format("dd/mm/yyyy")
                    var valid = new Date(parseInt(data[0].validity.substr(6))).format("dd/mm/yyyy")
                    var obj = new Object();
                    setControlValue("txtBusNumber", data[0].bus_number);
                    setControlValue("txtPermitNumber", data[0].permit_number);
                    setControlValue("txtOwnerName", data[0].bus_owner_name);
                    setControlValue("txtFatherName", data[0].owner_father_name);
                    setControlValue("txtAddress", data[0].owner_address);
                    setControlValue("txtMember", member);
                    setControlValue("txtSet", data[0].setid);
                    setControlValue("txtDipoo", data[0].bus_operating_center);
                    setControlValue("txtEntryDeposit", data[0].entry_amount);
                    setControlValue("txtReciptNo", data[0].entry_reciept_number);
                    setControlValue("txtCautionMoney", data[0].security_amount);
                    setControlValue("txtCautionMoneyReciptNo", data[0].security_money_reciept);
                    setControlValue("txtCautionMoneyDate", paymentDate);
                    setControlValue("txtRemainingMoney", data[0].remaining_amount);
                    setControlValue("txtTollTax", data[0].road_tax);
                    setControlValue("txtguarantor1Name", data[0].gauranter1);
                    setControlValue("txtguarantor1BusNumber", data[0].gauranter1_bus);
                    setControlValue("txtguarantor2Name", data[0].gauranter2);
                    setControlValue("txtguarantor2BusNumber", data[0].gauranter2_bus);
                    setControlValue("txtRegistrationNo", data[0].registration_number);
                    setControlValue("txtModel", data[0].model);
                    setControlValue("txtNoOfSeats", data[0].seats);
                    setControlValue("txtChassisNo", data[0].chesis_number);
                    setControlValue("txtEngineNo", data[0].engine_number);
                    setControlValue("txtFitness", data[0].fitness);
                    setControlValue("txtInsorance", data[0].Insorance);
                    setControlValue("txtValid", valid);
                    setControlValue("txtEmi", data[0].emi);
                    
                }
            });

        }
    });
</script>