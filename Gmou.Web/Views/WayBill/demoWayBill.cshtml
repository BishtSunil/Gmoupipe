@{
    ViewBag.Title = "Cash Vivrani";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@model Gmou.Web.Models.VivraniViewModel

@using System.Web;
<link href="~/Content/css/normalize.css" rel="stylesheet" />
<link href="~/Content/css/demo.css" rel="stylesheet" />
<link href="~/Content/css/component.css" rel="stylesheet" />
<script src="http://ajax.aspnetcdn.com/ajax/jquery.ui/1.9.2/jquery-ui.min.js" type="text/javascript"></script>

<script src="~/Scripts/Admin/validation.js"></script>
<script src="~/Scripts/LTE/ui/jquery-ui.js"></script>
<link href="~/Scripts/LTE/ui/jquery-ui.css" rel="stylesheet" />
<script src="~/Scripts/LTE/ui/date.format.js"></script>
<link href="~/Content/jquery.loader.css" rel="stylesheet" />
<script src="~/Scripts/GmouScripts/jquery.loader.js"></script>
<script src="~/Scripts/GmouScripts/jquery.confirm.min.js"></script>
<script src="~/Scripts/GmouScripts/autocompletedropdown.js"></script>

<link href="http://ajax.aspnetcdn.com/ajax/jquery.ui/1.9.2/themes/blitzer/jquery-ui.css"
      rel="Stylesheet" type="text/css" />


<style>
    .custom-combobox {
        position: relative;
        display: inline-block;
    }

    #EmployeesTable th, td {
        text-align: center;
    }

    .couponcolor {
        background-color: gold !important;
    }
    .ui-autocomplete {
  z-index:2147483647;
}
    .custom-combobox-toggle {
        position: absolute;
        top: 0;
        bottom: 0;
        margin-left: -1px;
        padding: 0;
        /* support: IE7 */
        *height: 1.7em;
        *top: 0.1em;
    }

    .custom-combobox-input {
        margin: 0;
        padding: 0.3em;
    }

    th {
        border: 1px solid black;
    }

    <style type="text/css" > .txt100 {
        width: 100px;
    }

    .modal-box {
        width: 650px;
    }

    .grdTrHoverEffect td, .grdTrHoverEffect th {
        text-align: left;
        line-height: 30px;
    }

    .grdTrHoverEffect tr:nth-child(2n+1) td {
        background-color: #eeeeee;
    }
</style>

<div id="busInformation">
    <div class="col-md-12 marT20">
        <div class="box box-success">
            <div class="boxHeading">
                <b>Bus Detail</b>
                <a href="" class="pull-right hide" id="ancAddNewStore" title="Add a Store"><i class="fa fa-plus"></i> Add Related Account</a>
                <div class="box-body table-responsive">
                    <table id="tblAccount" class="table" style="width:100%" class="tbl20 alignROdd">
                        <tbody>
                            <tr>
                                <td>
                                    Waybill Date
                                </td>
                                <td>
                                    <h5><input type="text" id="myVariable" name="myVariable" placeholder="dd-mm-yyyy"></h5>
                                </td>
                                <td>
                                    Waybill NO
                                </td>
                                <td>
                                    <input type="text" id="txtBookNo" />

                                </td>
                                <td>
                                    Waybill serial  NO
                                </td>
                                <td>
                                    <input type="text" id="txtBookserialNo" />

                                </td>
                            </tr>
                            <tr>
                                <td>
                                    bus number
                                </td>
                                <td>

                                    @Html.DropDownListFor(model => model.bus, Model.bus, new { @class = "txt100PValidBreak", id = "ddlBusNumber", accesskey = "a", style = "width: 135px;" })

                                </td>
                                
                                <td class="alignR">
                                    Dipoo
                                </td>
                                <td>
                                    <select id="ddlDipoo">
                                        <option value="1">Kotdwar</option>
                                        <option value="2">Pauri</option>
                                        <option value="3">Srinagar</option>
                                        <option value="4">RudarPrayag</option>
                                        <option value="5">Haridwar</option>
                                        <option value="6">Rishikesh</option>
                                        <option value="7">Karanprayag</option>
                                        <option value="8">Gopeshwar</option>
                                    </select>

                                </td>
                                <td>
                                    Reason
                                </td>
                                <td>
                                    <textarea id="txtReason" rows="3"></textarea>
                                </td>
                            </tr>


                            <tr>

                                <td>
                                   Station From
                                </td>
                                <td>
                                    <input type="text" id="txtArrival" name="nametxtStationFrom" />
                                </td>
                                <td>
                                    Station To
                                </td>
                                <td>
                                    <input type="text" id="txtDeparture" name="nametxtStationFrom" />
                                </td>
                                <td><label id="lblmissing"></label></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

            </div>

        </div>
    </div>
    <div class="col-md-12 marT20">

        <div class="box box-success">
            <div class="boxHeading">
                <b>Ticket Details</b>
                <a href="" class="pull-right hide" id="ancAddNewStore" title="Add a Store"><i class="fa fa-plus"></i> Add Related Account</a>
            </div>
            <div class="box-body table-responsive">
                <table id="tblWayBill" class="table">
                    <tr>
                        <th>Station From</th>
                        <th>Station To</th>
                        <th>Ticket Start</th>
                        <th>Ticket End</th>
                        <th>Ticket Sold</th>
                        <th>Fare</th>
                        <th>Coupon</th>
                    </tr>
                    <tbody>

                        <tr>

                            <td>
                                <input type="text" id="txtStationFrom" class="txt100" name="nametxtStationFrom" autocomplete="on" />
                              
                            </td>

                            <td>
                                <input type="text" id="txtStationTo" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="number" id="txtStartTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="number" id="txtEndTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="number" id="txtNoofTicket" class="txt100"  />
                            </td>


                            <td>
                                <input type="number" id="txtFare" class="txt100" onfocusout="Total(this);"  onfocus="PreviousValue(this);"/>
                            </td>
                            <td>
                                
                                <input type="checkbox" id="chkcoupon" data-count="1" onclick="chkCoupon(this);" />

                            </td>
                        </tr>
                        <tr>

                            <td>
                                <input type="text" id="txtStationFrom" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStationTo" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="number" id="txtStartTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="number" id="txtEndTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="number" id="txtNoofTicket" class="txt100" onfocusout="GetFareDistance(this);" /> 
                            </td>


                            <td>
                                <input type="text" id="txtFare" class="txt100" onfocusout="Total(this);"  onfocus="PreviousValue(this);"/>
                            </td>
                            <td>
                                <input type="checkbox" id="chkcoupon" onclick="chkCoupon(this);"/>

                            </td>
                        </tr>
                        <tr>

                            <td>
                                <input type="text" id="txtStationFrom" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStationTo" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStartTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtEndTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtNoofTicket" class="txt100" />
                            </td>


                            <td>
                                <input type="text" id="txtFare" class="txt100" onfocusout="Total(this);"  onfocus="PreviousValue(this);"/>
                            </td>
                            <td>
                                <input type="checkbox" id="chkcoupon" onclick="chkCoupon(this);"/>

                            </td>
                        </tr>
                        <tr>

                            <td>
                                <input type="text" id="txtStationFrom" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStationTo" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStartTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtEndTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtNoofTicket" class="txt100" />
                            </td>


                            <td>
                                <input type="text" id="txtFare" class="txt100" onfocusout="Total(this);"  onfocus="PreviousValue(this);"/>
                            </td>
                            <td>
                                <input type="checkbox" id="chkcoupon" onclick="chkCoupon(this);"/>

                            </td>
                        </tr>
                        <tr>

                            <td>
                                <input type="text" id="txtStationFrom" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStationTo" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStartTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtEndTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtNoofTicket" class="txt100" />
                            </td>


                            <td>
                                 <input type="text" id="txtFare" class="txt100" onfocusout="Total(this);"  onfocus="PreviousValue(this);"/>
                            </td>
                            <td>
                                <input type="checkbox" id="chkcoupon" onclick="chkCoupon(this);"/>
                            </td>
                        </tr>
                        <tr>

                            <td>
                                <input type="text" id="txtStationFrom" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStationTo" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStartTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtEndTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtNoofTicket" class="txt100" />
                            </td>


                            <td>
                                <input type="text" id="txtFare" class="txt100" onfocusout="Total(this);" onfocus="PreviousValue(this);"/>
                            </td>
                            <td>
                                <input type="checkbox" id="chkcoupon" onclick="chkCoupon(this);"/>

                            </td>
                        </tr>
                        <tr>

                            <td>
                                <input type="text" id="txtStationFrom" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStationTo" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStartTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtEndTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtNoofTicket" class="txt100" />
                            </td>


                            <td>
                                <input type="text" id="txtFare" onfocusout="Total(this)" onfocus="PreviousValue(this);"/> 
                            </td>
                            <td>
                                <input type="checkbox" id="chkcoupon" onclick="chkCoupon(this);"/>

                            </td>
                        </tr>
                        <tr>

                            <td>
                                <input type="text" id="txtStationFrom" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStationTo" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStartTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtEndTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtNoofTicket" class="txt100" />
                            </td>


                            <td>
                                 <input type="text" id="txtFare" class="txt100" onfocusout="Total(this);"  onfocus="PreviousValue(this);"/>
                            </td>
                            <td>
                                <input type="checkbox" id="chkcoupon" onclick="chkCoupon(this);"/>

                            </td>
                        </tr>
                        <tr>

                            <td>
                                <input type="text" id="txtStationFrom" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStationTo" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStartTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtEndTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtNoofTicket" class="txt100"  />
                            </td>


                            <td>
                                <input type="text" id="txtFare" class="txt100" onfocusout="Total(this);" onfocus="PreviousValue(this);" />
                            </td>
                            <td>
                                <input type="checkbox" id="chkcoupon" onclick="chkCoupon(this);"/>

                            </td>
                        </tr>
                        <tr>

                            <td>
                                <input type="text" id="txtStationFrom" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStationTo" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStartTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtEndTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtNoofTicket" class="txt100" />
                            </td>


                            <td>
                                 <input type="text" id="txtFare" class="txt100" onfocusout="Total(this);"  onfocus="PreviousValue(this);"/>
                            </td>
                            <td>
                                <input type="checkbox" id="chkcoupon" onclick="chkCoupon(this);"/>

                            </td>
                        </tr>
                        <tr>

                            <td>
                                <input type="text" id="txtStationFrom" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStationTo" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStartTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtEndTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtNoofTicket" class="txt100"  />
                            </td>


                            <td>
                                <input type="text" id="txtFare" class="txt100" onfocusout="Total(this);" onfocus="PreviousValue(this);" />
                            </td>
                            <td>
                                <input type="checkbox" id="chkcoupon" onclick="chkCoupon(this);"/>

                            </td>
                        </tr>
                        <tr>

                            <td>
                                <input type="text" id="txtStationFrom" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStationTo" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStartTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtEndTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtNoofTicket" class="txt100" />
                            </td>


                            <td>
                                 <input type="text" id="txtFare" class="txt100" onfocusout="Total(this);"  onfocus="PreviousValue(this);"/>
                            </td>
                            <td>
                                <input type="checkbox" id="chkcoupon" onclick="chkCoupon(this);"/>

                            </td>
                        </tr>
                        <tr>

                            <td>
                                <input type="text" id="txtStationFrom" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStationTo" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStartTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtEndTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtNoofTicket" class="txt100" />
                            </td>


                            <td>
                                 <input type="text" id="txtFare" class="txt100" onfocusout="Total(this);"  onfocus="PreviousValue(this);"/>
                            </td>
                            <td>
                                <input type="checkbox" id="chkcoupon" onclick="chkCoupon(this);"/>

                            </td>
                        </tr>
                        <tr>

                            <td>
                                <input type="text" id="txtStationFrom" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStationTo" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStartTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtEndTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtNoofTicket" class="txt100" />
                            </td>


                            <td>
                                 <input type="text" id="txtFare" class="txt100" onfocusout="Total(this);"  onfocus="PreviousValue(this);"/>
                            </td>
                            <td>
                                <input type="checkbox" id="chkcoupon" onclick="chkCoupon(this);"/>

                            </td>
                        </tr>
                        <tr>

                            <td>
                                <input type="text" id="txtStationFrom" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStationTo" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStartTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtEndTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtNoofTicket" class="txt100" />
                            </td>


                            <td>
                                 <input type="text" id="txtFare" class="txt100" onfocusout="Total(this);"  onfocus="PreviousValue(this);"/>
                            </td>
                            <td>
                                <input type="checkbox" id="chkcoupon" onclick="chkCoupon(this);"/>

                            </td>
                        </tr>
                        <tr>

                            <td>
                                <input type="text" id="txtStationFrom" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStationTo" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStartTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtEndTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtNoofTicket" class="txt100" />
                            </td>


                            <td>
                                 <input type="text" id="txtFare" class="txt100" onfocusout="Total(this);"  onfocus="PreviousValue(this);"/>
                            </td>
                            <td>
                                <input type="checkbox" id="chkcoupon" onclick="chkCoupon(this);"/>

                            </td>
                        </tr>
                        <tr>

                            <td>
                                <input type="text" id="txtStationFrom" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStationTo" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStartTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtEndTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtNoofTicket" class="txt100" />
                            </td>


                            <td>
                                 <input type="text" id="txtFare" class="txt100" onfocusout="Total(this);"  onfocus="PreviousValue(this);"/>
                            </td>
                            <td>
                                <input type="checkbox" id="chkcoupon" onclick="chkCoupon(this);"/>

                            </td>
                        </tr>
                        <tr>

                            <td>
                                <input type="text" id="txtStationFrom" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStationTo" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStartTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtEndTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtNoofTicket" class="txt100" />
                            </td>


                            <td>
                                 <input type="text" id="txtFare" class="txt100" onfocusout="Total(this);"  onfocus="PreviousValue(this);"/>
                            </td>
                            <td>
                                <input type="checkbox" id="chkcoupon" onclick="chkCoupon(this);"/>

                            </td>
                        </tr>
                        <tr>

                            <td>
                                <input type="text" id="txtStationFrom" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStationTo" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStartTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtEndTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtNoofTicket" class="txt100" />
                            </td>


                            <td>
                                 <input type="text" id="txtFare" class="txt100" onfocusout="Total(this);"  onfocus="PreviousValue(this);"/>
                            </td>
                            <td>
                                <input type="checkbox" id="chkcoupon" onclick="chkCoupon(this);"/>

                            </td>
                        </tr>
                        <tr>

                            <td>
                                <input type="text" id="txtStationFrom" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStationTo" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStartTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtEndTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtNoofTicket" class="txt100" />
                            </td>


                            <td>
                                 <input type="text" id="txtFare" class="txt100" onfocusout="Total(this);"  onfocus="PreviousValue(this);"/>
                            </td>
                            <td>
                                <input type="checkbox" id="chkcoupon" onclick="chkCoupon(this);"/>

                            </td>
                        </tr>
                        <tr>

                            <td>
                                <input type="text" id="txtStationFrom" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStationTo" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStartTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtEndTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtNoofTicket" class="txt100" />
                            </td>


                            <td>
                                 <input type="text" id="txtFare" class="txt100" onfocusout="Total(this);"  onfocus="PreviousValue(this);"/>
                            </td>
                            <td>
                                <input type="checkbox" id="chkcoupon" onclick="chkCoupon(this);"/>

                            </td>
                        </tr>
                        <tr>

                            <td>
                                <input type="text" id="txtStationFrom" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStationTo" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStartTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtEndTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtNoofTicket" class="txt100" />
                            </td>


                            <td>
                                 <input type="text" id="txtFare" class="txt100" onfocusout="Total(this);"  onfocus="PreviousValue(this);"/>
                            </td>
                            <td>
                                <input type="checkbox" id="chkcoupon" onclick="chkCoupon(this);"/>

                            </td>
                        </tr>
                        <tr>

                            <td>
                                <input type="text" id="txtStationFrom" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStationTo" class="txt100" name="nametxtStationFrom" />
                            </td>

                            <td>
                                <input type="text" id="txtStartTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtEndTicket" class="txt100" />
                            </td>

                            <td>
                                <input type="text" id="txtNoofTicket" class="txt100" />
                            </td>


                            <td>
                                 <input type="text" id="txtFare" class="txt100" onfocusout="Total(this);"  onfocus="PreviousValue(this);"/>
                            </td>
                            <td>
                                <input type="checkbox" id="chkcoupon" onclick="chkCoupon(this);"/>

                            </td>
                        </tr>
                        <tr>
                            <td><span> Mics.(+)</span></td>

                            <td><input type="text" id="txtMiscadd" class="txt100" onfocusout="Total(this);"  onfocus="PreviousValue(this);"/></td>

                            <td><span> Mics.(-)</span></td>

                            <td><input type="text" id="txtMiscsub" class="txt100" onfocusout="MinusTotal(this)" onfocus="PreviousValue(this);"; /></td>

                            <td>Gaman Patra</td>

                            <td><input type="text" id="txtGaman" class="txt100" onfocus="PreviousValue(this);" onfocusout="GamanPatra(this)" ; /></td>

                            <td>
                                <span> Total Amount Rs: </span> <label for="lblshowAdd" id="lblShowFare"></label>
                            </td>
                        </tr>
                        @*<tr>
                                <td>
                                    Ticket No
                                </td>
                                <td>
                                    <input type="text" id="txtFare" class="txt100" />
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    From
                                </td>
                                <td>
                                    <input type="text" id="txtStationFrom" class="txt100" name="nametxtStationFrom" />
                                </td>
                                <td>
                                    To
                                </td>
                                <td>
                                   <input type="text" id="txtStationTo" class="txt100"name="nametxtStationFrom" />
                                </td>

                            </tr>
                            <tr>
                                <td>
                                    Start(ticket No)
                                </td>
                                <td>
                                    <input type="text" id="txtTktStart" class="txt100" onkeyup="nooftckets(event)" />
                                </td>
                                <td>
                                    End(ticket No)
                                </td>
                                <td>
                                    <input type="text" id="txtTktEnd" class="txt100" onkeyup="nooftckets(event)" />
                                </td>
                                <td>
                                    Seats No.
                                </td>
                                <td>
                                    <select id="ddltotalseats">
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                        <option value="7">7</option>
                                        <option value="8">8</option>
                                    </select>
                                </td>
                                <td>
                                    No Of Ticket
                                </td>
                                <td>
                                    <label id="txtNoOfTicket"></label>
                                </td>

                            </tr>
                            <tr>

                                <td>
                                    Fare
                                </td>
                                <td>
                                    <input type="text" id="txtAmount" class="txt100" />
                                </td>
                                <td>
                                    Waybill Date
                                </td>
                                <td>
                                    <input type="text" id="txtWaybillDate" accesskey="a" class="txt100 datepicker" readonly="true">
                                    <img src="~/Images/calendar-icon-blue.png" style="margin-left: -4px;" />
                                </td>
                                <td><label id="lblticketmissing"></label></td>
                            </tr>
                            <tr>
                                <td><label>Is Coupon <input type="checkbox" id="chkIsCoupon" /></label></td>
                                <td><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">Add Cuppon</button></td>
                                <td>
                                    Reason
                                </td>
                                <td>
                                    <textarea id="txtTktReason" rows="3"></textarea>
                                </td>
                            </tr>*@

                    </tbody>
                </table>


            </div>
        </div>


    </div>
    <div class="box-footer clearfix" style="padding-right:30px">
        <input type="button" id="btnVivraniDetails" value="Save" class="pull-right btn btn-primary" style="padding:4px 22px 6px 15px;margin-left: 40px;" />
    </div>
    <div style="height:10px"></div>

    <div class="PageContent">


        <div id="dvPrintTable" class="PageContentWindow" style="text-align: center; font-size: 18px;">

            <table id="EmployeesTable">
                <thead>

                    <tr>

                        <th rowspan="2">
                            From
                        </th>
                        <th rowspan="2">
                            To
                        </th>
                        

                        <th colspan="2" style="text-align:center">TicketNo</th>

                        <th rowspan="2">
                            No Of Ticket
                        </th>

                        <th rowspan="2">
                            Waybill No
                        </th>
                        <th rowspan="2">
                            Waybill Serial No
                        </th>
                        <th rowspan="2">
                            amount
                        </th>
                    </tr>
                    <tr>

                        <th>
                            Ticket start
                        </th>
                        <th>
                            Ticket End
                        </th>



                    </tr>

                </thead>
            </table>
            <div id="ttlamtttxt" style="text-align: right;margin-right: 51px;" class="hide">Total Amount :- <span id="ttlamt">0</span></div>
           
        </div>
        <div style="height:10px"></div>
        <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">Add Cuppon</button>

        <button class="pull-right btn btn-primary" id="btnGenrate" type="button">
            Genrate Cash Vivrani
        </button>
        <button class="pull-right btn btn-primary hide" id="btnShow" type="button" onclick="showCashVivraani()">
            Show Cash Vivrani
        </button>

    </div>


</div>


<div class="container">



    <!-- Cuppon -->
    <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content" style="width: 148%">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" onclick="clearAllTextBoxes('tblAccount')">&times;</button>
                    <h4 class="modal-title">Cuppon</h4>

                </div>
                <div class="modal-body box-body table-responsive" id="pnlCoupon">
                    <table id="tblAccount" style="width:80%" class="tbl20 alignROdd">
                        <tbody>
                           
                            <tr>
                              
                                <td>Bus
                                    @Html.DropDownListFor(model => model.bus, Model.bus, new { @class = "txt100PValidBreak", id = "ddlBusNumber_trans_from", accesskey = "a", style = "width: 135px;" })


                                </td>
                                <td>
                                    WayBill Book No
                              

                               
                                    <input type="text" id="txtwaybillno_from" />
                                </td>
                           
                                <td>
                                    WayBill Serial No
                                                                   <input type="text" id="txtwaybillserial_from" />
                                </td>
                                <td>
                                    Amount
                                
                                    <input type="text" id="txtamount_from" />
                                </td>
                            </tr>

                            <tr>

                                <td>
                                    Bus
                                    @Html.DropDownListFor(model => model.bus, Model.bus, new { @class = "txt100PValidBreak", id = "ddlBusNumber_trans_to", accesskey = "a", style = "width: 135px;" })


                                </td>
                                <td>
                                    WayBill Book No



                                    <input type="text" id="txtwaybillno_to" />
                                </td>

                                <td>
                                    WayBill Serial No
                                    <input type="text" id="txtwaybillserial_to" />
                                </td>
                                <td>
                                    Amount

                                    <input type="text" id="txtamount_to" />
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <div style="height:10px"></div>
                    <div style="text-align:right">
                        <button type="button" class="btn btn-default" onclick="saveTranshipmentDetail()">Save</button>
                        <button type="button" id="btnClose" class="btn btn-default" data-dismiss="modal" onclick="clearAllTextBoxes('tblAccount')">Close</button>
                    </div>
                </div>
                <div class="modal-footer">



                </div>
            </div>
        </div>
    </div>

    <!-- Warrent -->
    <div class="modal fade" id="myModal1" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Cuppon</h4>
                </div>
                <div class="modal-body">
                    <table id="tblAccount" style="width:100%" class="tbl20 alignROdd">
                        <tbody>
                            <tr>
                                <td>
                                    Issuing Date
                                </td>
                                <td>
                                    <input type="text" id="txtIssuingDate" class="datepicker txt100" />
                                    <img src="~/Images/calendar-icon-blue.png" style="margin-left: -4px;" />
                                </td>
                                <td>
                                    Warrent No
                                </td>
                                <td>
                                    <input type="text" id="txtWarrentNo" />
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    bus number
                                </td>
                                <td>
                                    @Html.DropDownListFor(model => model.bus, Model.bus, new { @class = "txt100PValidBreak", id = "ddlBusNumber", accesskey = "a", style = "width: 135px;" })
                                </td>

                            </tr>



                        </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" onclick="saveWarrent()">Save</button>
                    <button type="button" id="btnClose" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    var total = 0;
    var prevvalue = 0;
    function chkCoupon(e)
    {
      

    }
    function PreviousValue(e)
    {
      
        if(e.value!="")
        {
            prevvalue = parseFloat(e.value);
        }
    }
    function Total(e) {

       
        if (e.value != "") {
            if (prevvalue != 0)
            {
                total = total - prevvalue;
                prevvalue = 0;
            }
            
            total = total + parseFloat(e.value);
            $('#lblShowFare').text(total);
           
        }
        else {
            total = total - prevvalue;
            prevvalue = 0;
            $('#lblShowFare').text(total);
        }
    }
    function MinusTotal(e) {

      
        if (e.value != "") {
            if (prevvalue != 0) {
                total = total + prevvalue;
                prevvalue = 0;
            }

            total = total - parseFloat(e.value);
            $('#lblShowFare').text(total);

        }
        else {
            total = total + prevvalue;
            prevvalue = 0;
            $('#lblShowFare').text(total);
        }
    }
    function GamanPatra(e) {

       
        if (e.value != "") {
            if (prevvalue != 0) {
                total = total + prevvalue;

            }
            total = total - parseFloat(e.value);
            $('#lblShowFare').text(total);

        }
        else {
            total = total + prevvalue;
            prevvalue = 0;
            $('#lblShowFare').text(total);
        }
    }
    $(function () {
        $('#myVariable').datepicker({ dateFormat: 'dd-mm-yy' });
    });

    
    function GetFareDistance(e) {
       

        var stationfrom = e.parentElement.parentElement.children[0].children.txtStationFrom.value;
        var stationto = e.parentElement.parentElement.children[1].children.txtStationTo.value;

        var ticketsold = parseInt(e.value);


        $.ajax({
            type: "GET",
            url: '/WayBill/GetDistancePrice?from=' + stationfrom + '&to=' + stationto,

            dataType: "json",


            contentType: 'application/json; charset=utf-8',
            success: function (data) {

                e.parentElement.parentElement.children[5].children.txtFare.value = ticketsold * data;
            }

        });
    }
    var TottalFare = 0;
    $(document).ready(function () {

        $('#txtArrival').focusout(function () {

           // CheckValidWayBill();
          
        });
        $('input').on('ifChecked', function (event, e) {
           
            if (event.currentTarget.dataset.count == "1") {
                var coupon = parseFloat(event.currentTarget.parentElement.parentElement.parentElement.children[5].children.txtFare.value);
                var currenttotalfare = parseFloat($('#lblShowFare').text());
                total = total - coupon;
                $('#lblShowFare').text(total);
            }
            else {
                var coupon = parseFloat(event.currentTarget.parentElement.parentElement.parentElement.children[5].children.txtFare.value);
                var currenttotalfare = parseFloat($('#lblShowFare').text());
                total = total - coupon;
                $('#lblShowFare').text(total);
            }
        });
       
        $('input').on('ifUnchecked', function (event, e) {
            ;

            if (event.currentTarget.dataset.count == "1") {
                var coupon = parseFloat(event.currentTarget.parentElement.parentElement.parentElement.children[5].children.txtFare.value);
                var currenttotalfare = parseFloat($('#lblShowFare').text());
                total = total - coupon;
                $('#lblShowFare').text(total);
            }
            else {
                var coupon = parseFloat(event.currentTarget.parentElement.parentElement.parentElement.children[5].children.txtFare.value);
                var currenttotalfare = parseFloat($('#lblShowFare').text());
                total = total +coupon;
                $('#lblShowFare').text(total);
            }
        });

        
        $("#btnVivraniDetails").click(function () {
            $.confirm({
                text: "WayBill is Rs." + $('#lblShowFare').val() + " will be added",
                confirm: function (button) {
                    saveWaybillDetail();
                },
                cancel: function (button) {

                }
            });

            $("#btnGenrate").click(function () {
                $.confirm({
                    text: '<table><tr><td>Enter Vivrani Serial number</td><td>  <input type="text" id="txtvivraniNo" /></td></tr></table>',
                    confirm: function (button) {
                        genrateCasVivraani(getControlValue("txtvivraniNo"));
                    },
                    cancel: function (button) {

                    }
                });
            });
        });

        $('#txtBookserialNo').focusout(function () {
            CheckValidSerialno();
        });
        $('#txtBookserialNo').focusin(function () {
            HideErrorMessage();
        });
        $('#txtTktStart').focusout(function () {
            CheckValidTicketSerialno();
        });
        $('#txtTktStart').focusin(function () {
            HideTicketErrorMessage();
        });
        $('#chkcoupon').change(function () {
            alert($(this).prop('checked'))
        })
        $('#chkcoupon').change(function ()

        {
            ;
        });
        $("[name='nametxtStationFrom']").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: '/WayBill/AutoComplete/',
                    data: "{ 'prefix': '" + request.term + "'}",
                    dataType: "json",
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    success: function (data) {
                        response($.map(data, function (item) {
                            return item;
                        }))
                    },
                    error: function (response) {
                        alert(response.responseText);
                    },
                    failure: function (response) {
                        alert(response.responseText);
                    }
                });
            },
            select: function (e, i) {

            },
            minLength: 1
        });

        //source: function (request, response) {
        //    $.ajax({
        //        url: '/WayBill/AutoComplete/',
        //        data: "{ 'prefix': '" + request.term + "'}",
        //        dataType: "json",
        //        type: "POST",
        //        contentType: "application/json; charset=utf-8",
        //        success: function (data) {
        //            response($.map(data, function (item) {
        //                return { label: item.Country, value: item.Country };
        //            }))

        //        }
        //    })
        //},
        //messages: {
        //    noResults: "", results: ""
        //}
    });


    function Validate()
    {

        if( getControlValue("myVariable")=="" && getControlValue("txtBookNo")=="" && getControlValue("txtBookserialNo")=="" && getControlValue("txtArrival")=="" && getControlValue("txtDeparture")=="" )


        {

            alert('Some Value are Missing');
        }
        else
        {
            return true;
        }
        

        

        
    }


    function printdiv(printpage) {
        var headstr = "<html><head><title></title></head><body>";
        var footstr = "</body>";
        var newstr = document.all.item(printpage).innerHTML;
        var oldstr = document.body.innerHTML;
        document.body.innerHTML = headstr + newstr + footstr;
        window.print();
        document.body.innerHTML = oldstr;
        return false;
    }
    function CalculateFare() {


    }
    function CheckValidTicketSerialno() {
        $.ajax({
            type: "GET",
            url: "/WayBill/ValidateTicketSerialNumber",
            data: { ticketstartno: $('#txtTktStart').val(), ticketno: $('#txtFare').val(), busID: $('#ddlBusNumber').val() },
            datatype: "json",
            traditional: true,
            success: function (data) {
                if (data != null) {

                    if (data == true) {
                        HideTicketErrorMessage();

                    }
                    else {
                        ShowTicketErrorMessage();
                    }


                }
            }
        });

    }

    function CheckValidWayBill() {
        $.ajax({
            type: "GET",
            url: "/WayBill/CheckWayBillExistence",
            data: { busid: $('#ddlBusNumber').val(), waybillBookNo: $('#txtBookNo').val(), waybillSerrialNo: $('#txtBookserialNo').val() },
            datatype: "json",
            traditional: true,
            success: function (data) {
                if (data != null) {

                    if (data == false) {
                       alert("WayBill Already Exist")

                    }
                   


                }
            }
        });

    }
    function CheckValidSerialno() {
        $.ajax({
            type: "GET",
            url: "/WayBill/ValidateWayBillSerialNumber",
            data: { waybillserialno: $('#txtBookserialNo').val(), waybillbookno: $('#txtBookNo').val(), busID: $('#ddlBusNumber').val() },
            datatype: "json",
            traditional: true,
            success: function (data) {
                if (data != null) {

                    if (data == true) {
                        HideErrorMessage();

                    }
                    else {
                        ShowErrorMessage();
                    }


                }
            }
        });

    }
    function HideErrorMessage() {
        $('#txtVSerialNo').css('background-color', 'white')
        $('#lblmissing').css("color", "red");
        $('#lblmissing').hide();
        $('#lblmissing').text("")



    }
    function ShowErrorMessage() {
        $('#lblmissing').show();
        $('#txtVSerialNo').css('background-color', 'red')
        $('#lblmissing').css("color", "red");
        $('#lblmissing').text("Serial number is missing.Please Give the Reason")
    }
    function HideTicketErrorMessage() {
        $('#txtTktStart').css('background-color', 'white')
        $('#lblticketmissing').css("color", "red");
        $('#lblticketmissing').hide();
        $('#lblticketmissing').text("")



    }
    function ShowTicketErrorMessage() {
        $('#lblticketmissing').show();
        $('#txtTktStart').css('background-color', 'red')
        $('#lblticketmissing').css("color", "red");
        $('#lblticketmissing').text("Serial number is missing.Please Give the Reason")
    }

    $(function () {
        $(".datepicker").datepicker({ dateFormat: 'dd-mm-yy' });

    });
    function DateTimeFunction(id) {
        var dt = getControlValueN(id);
        if (dt != null) {
            var day = dt.split("-");
            var d = new Date(day[2], day[1], day[0]);
            return d.toLocaleDateString();
        }
    }


    function calcTotalAmount() {

        var calcAmount = parseFloat(getControlValue("txtPrice")) * parseFloat(getControlValue("txtFuelQuantity"));;

        setControlValue("txtAmount", calcAmount);
    }
    function nooftckets() {
        ;

        var a = getControlValue("txtTktStart");
        var b = getControlValue("txtTktEnd");
        if ((a == "") || (b == "") || (a > b)) {
            setControlValue("txtNoOfTicket", 0)
        }
        else {
            var noofticket = b - a + 1;
            setControlValue("txtNoOfTicket", noofticket)
        }
    }

    function genrateCasVivraani(vivraniid) {
        ;
        var busId = getControlValue("ddlBusNumber");
        $.ajax({
            type: "GET",
            url: '/WayBill/GenerateCashVivrani?busId=' + busId + "&vivraniid=" + vivraniid,
            //data: { 'busId': busId},
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data == true) {
                    $("#btnShow").removeClass("hide");
                    $("#btnGenrate").addClass("hide");
                }
            },
            error: OnError
        });
    }

    function showCashVivraani() {
        ;
        var busId = getControlValue("ddlBusNumber");
        var wayBillNo = getControlValue("txtBookNo");
        var url = "/waybill/showCashVivraani?busId=" + busId + "&waybillNo=" + wayBillNo;
        window.location.href = url;
    }
    function saveWaybillDetail() {
        ;

        if (Validate()) {
            textboxes = $('#tblAccount').find('.txt100');
            str = "";
            var WayBillTicketModel = {


                BusNumber: getControlValueN("ddlBusNumber"),
                JourneyFrom: getControlValueN("txtDeparture"),
                JourneyTo: getControlValueN("txtArrival"),
                WayBillNo: getControlValueN("txtBookNo"),
                WayBillSerialNo: getControlValueN("txtBookserialNo"),
                GamanPatar: $('#txtGaman').val(),
                MiscPlus: $('#txtMiscadd').val(),
                MiscMinus: $('#txtMiscsub').val(),
                ticketdetails: []

            };

            $('#tblWayBill tr').each(function (item, value) {
                ;
                var iscoupon;
                if (item != 0) {

                    var test = $(this).find('input');
                    if (test.length != 0) {
                        if (test[0].value == "") {
                            return false;
                        }
                        if (test[6].parentElement.classList[1] == "checked") {
                            iscoupon = true;
                        }
                        else {
                            iscoupon = false;
                        }
                        WayBillTicketModel.ticketdetails.push({
                            "StationFrom": test[0].value,
                            "StationTo": test[1].value,
                            "StartTicket": test[2].value,//   Issue here if you don't specify the decimal place
                            "EndTicket": test[3].value,
                            "NoofTicket": test[4].value,
                            "TicketFare": test[5].value,
                            "IsCoupon": iscoupon,

                        });
                    }
                }


            });
            ;


            //var valid = validateTextBoxes('busInformation');
            //if (valid == true) {
            //    var obj = new Object();
            //    if ($('#chkIsCoupon').is(':checked')) {
            //        obj.IsCoupon = true;
            //    }
            //    else{
            //        obj.IsCoupon = false;
            //    }

            //    obj.BusNumber = getControlValueN("ddlBusNumber");
            //    obj.JourneyFrom = getControlValueN("txtStationFrom");
            //    obj.JourneyTo = getControlValueN("txtStationTo");
            //    obj.WayBillNo = getControlValueN("txtBookNo");
            //    obj.WayBillSerialNo = getControlValueN("txtBookserialNo");
            //    obj.TicketStart = getControlValueN("txtTktStart");
            //    obj.TicketEnd = getControlValueN("txtTktEnd");
            //    obj.StationFrom = getControlValueN("txtArrival");
            //    obj.StationTo = getControlValueN("txtDeparture");
            //    obj.Dipo = getControlValueN("ddlDipoo");
            //    obj.Fare = getControlValueN("txtAmount");
            //    obj.WayBillDate = getControlValueN("txtWaybillDate");
            //    obj.TicketNo = getControlValueN("txtFare");
            //    obj.IsCoupon = getControlValueN("chkIsCoupon");
            //    obj.TotalAmount = getControlValueN("ttlamt");
            //    obj.NumberOfTicket = getControlValueN("txtNoOfTicket");
            //    obj.TotalSeats =getControlValueN("ddltotalseats");
            //    obj.TicketNo = getControlValueN("txtFare");
            //   // alert(obj.WayBillDate);

            $.ajax({
                type: "POST",
                url: '/WayBill/SaveWayBillEntry',
                data: JSON.stringify(WayBillTicketModel),

                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (result) {
                    if (result == false) {
                        alert("Waybill Aready Exist")
                    }
                    else {
                        alert("Done");
                        setControlValue("txtStationFrom", "");
                        setControlValue("txtStationTo", "");
                        setControlValue("txtTktStart", "");
                        setControlValue("txtTktEnd", "");
                        setControlValue("txtAmount", "");
                        setControlValue("txtNoOfTicket", "");

                        showWaybllDetail(result);
                    }


                },
                error: OnError
            });
        }
    }

    function AddClick() {

    }
    function showWaybllDetail(data) {
        var totalamount = 0;
        var couponamount = 0;

        $("#ttlamtttxt").removeClass("hide")

        if (data) {
            var len = data.length;
            var txt = "";
            if (len > 0) {
                ;
                for (var i = 0; i < len; i++) {
                    ;
                    if (data[i].Iscoupon == true)
                    {
                       // couponamount = Number(couponamount) + Number(data[i].TicketFare);
                    }
                    else
                    {
                        totalamount = Number(totalamount) + Number(data[i].TicketFare);
                       
                        var noOftkt = data[i].TicketEnd - data[i].TicketStart + 1;
                    }
                   
                    if (data[i].Iscoupon == true) {

                     
                        txt += "<tr><td class=couponcolor>" + data[i].StationFrom + "</td><td class=couponcolor>" + data[i].StationTo + "</td>"
                           + "<td class=couponcolor>" + data[i].StartTicket + "</td><td class=couponcolor>" + data[i].EndTicket + "</td>"
                           + "<td class=couponcolor>" + data[i].NoofTicket + "</td>"
                           + "<td class=couponcolor>" + data[i].WayBillNo + "</td><td class=couponcolor>" + data[i].WayBillSerialNo + "</td>"
                            + "<td class=couponcolor>" + data[i].TicketFare + "</td></tr>"


                    }
                    else {
                        txt += "<tr><td>" + data[i].StationFrom + "</td><td>" + data[i].StationTo + "</td>"
                            + "<td>" + data[i].StartTicket + "</td><td>" + data[i].EndTicket + "</td>"
                            + "<td>" + data[i].NoofTicket + "</td>"
                            + "<td>" + data[i].WayBillNo + "</td><td>" + data[i].WayBillSerialNo + "</td>"
                             + "<td>" + data[i].TicketFare + "</td></tr>"
                            


                    }


                }
                ;
                setControlValue("ttlamt", totalamount);
                if (txt != "") {
                    $("#EmployeesTable").append(txt);
                    if (data[0].MiscPlus != 0) {
                        var txtmic = "<tr><td></td><td></td>"
                                + "<td></td><td></td>"
                                + "<td></td>"
                                + "<td></td><td>Misc(+)</td>"
                                 + "<td>" + data[0].MiscPlus + "</td></tr>"
                        $("#EmployeesTable").append(txtmic);
                        totalamount = Number(totalamount) + Number(data[0].MiscPlus);
                        setControlValue("ttlamt", totalamount);
                    }
                    if (data[0].MiscMinus != 0) {
                        var txtmicminus = "<tr><td></td><td></td>"
                              + "<td></td><td></td>"
                              + "<td></td>"
                              + "<td></td><td>Misc(-)</td>"
                               + "<td>" + data[0].MiscMinus + "</td></tr>"
                        $("#EmployeesTable").append(txtmicminus);
                        totalamount = Number(totalamount) - Number(data[0].MiscMinus);
                        setControlValue("ttlamt", totalamount);
                    }
                    if (data[0].GamanPatar != 0) {
                        var gaman = "<tr><td></td><td></td>"
                              + "<td></td><td></td>"
                              + "<td></td>"
                              + "<td></td><td>Gaman Patar</td>"
                               + "<td>" + data[0].GamanPatra + "</td></tr>"
                        $("#EmployeesTable").append(gaman);
                        totalamount = Number(totalamount) - Number(data[0].GamanPatar);
                        setControlValue("ttlamt", totalamount);
                    }
                }
            }
        }
    }
    (function ($) {
        $.widget("custom.combobox", {
            _create: function () {
                this.wrapper = $("<span>")
                  .addClass("custom-combobox")
                  .insertAfter(this.element);

                this.element.hide();
                this._createAutocomplete();
                this._createShowAllButton();
            },

            _createAutocomplete: function () {
                var selected = this.element.children(":selected"),
                  value = selected.val() ? selected.text() : "";

                this.input = $("<input>")
                  .appendTo(this.wrapper)
                  .val(value)
                  .attr("title", "")
                  .addClass("custom-combobox-input ui-widget ui-widget-content ui-state-default ui-corner-left")
                  .autocomplete({
                      delay: 0,
                      minLength: 0,
                      source: $.proxy(this, "_source")
                  })
                  .tooltip({
                      tooltipClass: "ui-state-highlight"
                  });

                this._on(this.input, {
                    autocompleteselect: function (event, ui) {
                        ui.item.option.selected = true;
                        this._trigger("select", event, {
                            item: ui.item.option
                        });
                    },

                    autocompletechange: "_removeIfInvalid"
                });
            },

            _createShowAllButton: function () {
                var input = this.input,
                  wasOpen = false;

                $("<a>")
                  .attr("tabIndex", -1)
                  .tooltip()

                  .appendTo(this.wrapper)
                  .button({
                      icons: {
                          primary: "ui-icon-triangle-1-s"
                      },
                      text: false
                  })
                  .removeClass("ui-corner-all")
                  .addClass("custom-combobox-toggle ui-corner-right")
                  .mousedown(function () {
                      wasOpen = input.autocomplete("widget").is(":visible");
                  })
                  .click(function () {
                      input.focus();

                      // Close if already visible
                      if (wasOpen) {
                          return;
                      }

                      // Pass empty string as value to search for, displaying all results
                      input.autocomplete("search", "");
                  });
            },

            _source: function (request, response) {
                var matcher = new RegExp($.ui.autocomplete.escapeRegex(request.term), "i");
                response(this.element.children("option").map(function () {
                    var text = $(this).text();
                    if (this.value && (!request.term || matcher.test(text)))
                        return {
                            label: text,
                            value: text,
                            option: this
                        };
                }));
            },

            _removeIfInvalid: function (event, ui) {

                // Selected an item, nothing to do
                if (ui.item) {
                    return;
                }

                // Search for a match (case-insensitive)
                var value = this.input.val(),
                  valueLowerCase = value.toLowerCase(),
                  valid = false;
                this.element.children("option").each(function () {
                    if ($(this).text().toLowerCase() === valueLowerCase) {
                        this.selected = valid = true;
                        return false;
                    }
                });

                // Found a match, nothing to do
                if (valid) {
                    return;
                }

                // Remove invalid value
                this.input
                  .val("")
                this.element.val("");
                this._delay(function () {
                    this.input.tooltip("close").attr("title", "");
                }, 2500);
                this.input.data("ui-autocomplete").term = "";
            },

            _destroy: function () {
                this.wrapper.remove();
                this.element.show();
            }
        });
    })(jQuery);
    $(function () {
        $("#ddlBusNumber_trans_to").combobox();
        $("#ddlBusNumber_trans_from").combobox();
        $("#ddlBusNumber").combobox();
        $("#toggle").click(function () {
            $("#ddlBusNumber").toggle();
            $("#ddlBusNumber_trans_to").toggle();
            $("#ddlBusNumber_trans_from").toggle();
           
        });




    });
  

    function saveTranshipmentDetail() {

        var obj = new Object();

        obj.BusFrom = getControlValueN("ddlBusNumber_trans_from");
        obj.BusTo = getControlValueN("ddlBusNumber_trans_to");
        obj.WaybillFrom = getControlValueN("txtwaybillno_from");
        obj.waybillserialfrom = getControlValueN("txtwaybillserial_from");
        obj.WaybilTo = getControlValueN("txtwaybillno_to");
        obj.waybillserialTo = getControlValueN("txtwaybillserial_to");
        obj.AmountTo = getControlValueN("txtamount_to");
        obj.AmountFrom = getControlValueN("txtamount_from");

        $.ajax({
            type: "POST",
            url: '/WayBill/SaveTranshipmentDetails',
            data: JSON.stringify(obj),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data == true) {
                    document.getElementById("btnClose").click();
                    alert("Done");
                }
                else {
                    alert("Error");
                }
            },
            error: OnError
        });
    }

    function GetData(e) {
        debugger;
        var obj = new Object();


        var busid = $(e).val();
        $.ajax({
            type: "GET",
            url: '/WayBill/GetWayBillDetails?busid=' + busid,

            dataType: "json",
            data: JSON.stringify(obj),

            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                if (data) {
                    //alert(data);
                    $("#" + $(e).attr("chaildId")).val(data);
                    $("#" + $(e).attr("chaildID2")).val("1");
                }
            }

        });
    }
</script>
